{
  extends: [
    'config:recommended',
    ':semanticCommits',
    ':prConcurrentLimit10',
    ':prHourlyLimit4',
    ':dependencyDashboard',
  ],
  schedule: [
    'before 7am',
  ],
  rebaseWhen: 'behind-base-branch',
  timezone: 'America/New_York',
  includePaths: [
    'kubernetes/apps/**',
    'kubernetes/games/**',
    'kubernetes/infrastructure/**',
    '.github/workflows/**',
  ],
  enabledManagers: [
    'github-actions',
    'dockerfile',
    'helm-values',
    'custom.regex',
  ],
  labels: [
    'dependencies',
    'renovate',
  ],
  dependencyDashboard: true,
  dependencyDashboardAutoclose: true,
  dependencyDashboardTitle: 'Renovate Dependency Dashboard',
  dependencyDashboardLabels: [
    'dependencies',
    'renovate',
    'dashboard',
  ],
  reviewers: [
    'hevel86',
  ],
  assignees: [
    'hevel86',
  ],
  ignorePaths: [
    'kubernetes/testing/**',
    '**/_archive/**',
    '**/*.disabled',
    '**/vendor/**',
    '**/charts/**',
  ],
  packageRules: [
    {
      description: 'Group all patch updates',
      matchUpdateTypes: [
        'patch',
      ],
      groupName: 'Patch updates',
      groupSlug: 'patch-updates',
    },
    {
      description: 'Automerge safe updates for GitHub Actions',
      matchManagers: [
        'github-actions',
      ],
      matchUpdateTypes: [
        'minor',
        'patch',
      ],
      automerge: true,
      automergeType: 'pr',
      labels: [
        'dependencies',
        'renovate',
        'automerge',
      ],
    },
    {
      description: 'Allow mylar3 only semver ls tags',
      matchDatasources: [
        'docker',
      ],
      matchPackageNames: [
        'lscr.io/linuxserver/mylar3',
      ],
      allowedVersions: '/^v?d+.d+.d+(?:-lsd+)?$/',
    },
    {
      description: 'Limit linuxserver tags to semver-style releases',
      matchDatasources: [
        'docker',
      ],
      allowedVersions: '/^\\d{1,3}\\.\\d+\\.\\d+(?:-[A-Za-z0-9._-]+)?$/',
      matchPackageNames: [
        'lscr.io/linuxserver/{/,}**',
      ],
    },
  ],
  customManagers: [
    {
      customType: 'regex',
      description: 'Update Docker image tags in Kubernetes manifests',
      managerFilePatterns: [
        '/^kubernetes/(apps|games|infrastructure)/.*\\.ya?ml$/',
      ],
      matchStrings: [
        'image:\\s*[\'"]?(?<depName>[a-zA-Z0-9_./-]+):(?<currentValue>[a-zA-Z0-9._-]+)',
      ],
      datasourceTemplate: 'docker',
      versioningTemplate: 'docker',
    },
    {
      customType: 'regex',
      description: 'Update Docker image tags inside Helm values blocks',
      managerFilePatterns: [
        '/^kubernetes/(apps|games|infrastructure)/.*\\.ya?ml$/',
      ],
      matchStrings: [
        'repository:\\s*[\'"]?(?<depName>[a-zA-Z0-9_./-]+)[\'"]?\\s*\\n\\s*tag:\\s*[\'"]?(?<currentValue>[a-zA-Z0-9._-]+)',
      ],
      datasourceTemplate: 'docker',
      versioningTemplate: 'docker',
    },
    {
      customType: 'regex',
      description: 'Update Helm chart releases in Argo CD Applications',
      managerFilePatterns: [
        '/^kubernetes/(apps|games|infrastructure)/.*\\.ya?ml$/',
      ],
      matchStrings: [
        'repoURL:\\s*(?<registryUrl>https?://\\S+)[\\s\\S]*?chart:\\s*(?<depName>[\\w./-]+)[\\s\\S]*?targetRevision:\\s*[\'"]?(?<currentValue>[^\'"\\s#]+)',
      ],
      datasourceTemplate: 'helm',
      registryUrlTemplate: '{{registryUrl}}',
    },
  ],
}
